<?xml version="1.0"?>
<project name="com.buglabs.osgi" default="jar">
	<property name="project.description" value="BUG OSGi Bundles" />
	<property name="external.dir" location="${basedir}/external" />

	<property name="wget.bin" location="/usr/bin/wget" />
	<property name="svn.bin" location="/usr/bin/svn" />
	<property name="git.bin" location="/usr/bin/git" />

	<property name="framework.version" value="3.2.2" />
	<property name="log.version" value="1.0.1" />
	<property name="configadmin.version" value="1.2.8" />
	<property name="compendium.version" value="1.4.0" />

	<property name="framework.fqpn" value="org.apache.felix.framework" />
	<property name="log.fqpn" value="org.apache.felix.log" />
	<property name="configadmin.fqpn" value="org.apache.felix.configadmin" />
	<property name="compendium.fqpn" value="org.osgi.compendium" />

	<property name="apache.mirror" value="http://ftp.riken.jp/net/apache/felix/" />

	<tstamp>
		<format property="TS_NOW" pattern="yyyy-MM-dd HH:mm:ss" />
	</tstamp>


	<target name="clean" description="remove intermediate files">
		<delete dir="classes" />
		<delete dir="external" />
	</target>

	<target name="fetch.dependencies">
		<mkdir dir="${external.dir}" />

		<exec executable="${wget.bin}">
			<arg value="--directory-prefix ${external.dir}" />
			<arg value="${apache.mirror}${framework.fqpn}-${framework.version}.jar" />
		</exec>

		<exec executable="${wget.bin}">
			<arg value="--directory-prefix ${external.dir}" />
			<arg value="${apache.mirror}${log.fqpn}-${log.version}.jar" />
		</exec>

		<exec executable="${wget.bin}">
			<arg value="--directory-prefix ${external.dir}" />
			<arg value="${apache.mirror}${configadmin.fqpn}-${configadmin.version}.jar" />
		</exec>

		<exec executable="${wget.bin}">
			<arg value="--directory-prefix ${external.dir}" />
			<arg value="${apache.mirror}${compendium.fqpn}-${compendium.version}.jar" />
		</exec>

		<exec executable="${wget.bin}">
			<arg value="--directory-prefix ${external.dir}" />
			<arg value="${apache.mirror}javax.servlet-1.0.0.jar" />
		</exec>
	</target>

	<target name="compile" depends="fetch.dependencies" description="compile the Java source code to class files">
		<ant dir="${basedir}/com.buglabs.common" target="compile" />
		<ant dir="${basedir}/com.buglabs.bug.ws" target="compile" />
		<ant dir="${basedir}/com.buglabs.bug.bmi" target="compile" />
	</target>

	<target name="jar" depends="compile" description="create a Jar file for the application">
		<ant dir="${basedir}/com.buglabs.common" target="jar" />
		<ant dir="${basedir}/com.buglabs.bug.ws" target="jar" />
		<ant dir="${basedir}/com.buglabs.bug.bmi" target="jar" />
	</target>

	<target name="javadoc" depends="jar">
		<ant dir="${basedir}/com.buglabs.common" target="javajar" />
		<ant dir="${basedir}/com.buglabs.bug.ws" target="javajar" />
		<ant dir="${basedir}/com.buglabs.bug.bmi" target="javajar" />
	</target>
</project>